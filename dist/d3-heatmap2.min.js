!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("d3")):"function"==typeof define&&define.amd?define(["exports","d3"],e):e(t.d3=t.d3||{},t.d3)}(this,function(t,e){"use strict";t.heatmap=function(){var t=null,n=0,r=0,a="",l="",i="",o=960,s={top:20,right:0,bottom:0,left:0},u=null,c=null,f=null,h=null,g=e.format(".0f"),d=e.format(".2s"),p=null,x=null,m=function(t){return t},y=function(t){return t},v=!1,b=null,L=null,w=[],A="#936EB5",k="0.4",F=!1;function E(){if(w&&w.length>0&&t&&r&&u){var e=function(){var t=[];for(var e in w)if(w[e].start[0]<=w[e].end[0])for(var n=w[e].start[0];n<=w[e].end[0];n++){var a=null;if(n>w[e].start[0]&&n<w[e].end[0])for(a=0;a<r;a++)t.push([n,a]);else if(n===w[e].start[0])if(F)if(n===w[e].end[0])if(w[e].start[1]>=w[e].end[1])for(a=w[e].start[1];a>=w[e].end[1];a--)t.push([n,a]);else console.log("Error: Start row is higher than end row. No reverse range highlight.");else for(a=w[e].start[1];a>=0;a--)t.push([n,a]);else if(n===w[e].end[0])if(w[e].start[1]<=w[e].end[1])for(a=w[e].start[1];a<=w[e].end[1];a++)t.push([n,a]);else console.log("Error: Start row is higher than end row. No reverse range highlight.");else for(a=w[e].start[1];a<r;a++)t.push([n,a]);else if(F)for(a=w[e].end[1];a<r;a++)t.push([n,a]);else for(a=w[e].end[1];a>=0;a--)t.push([n,a])}else console.log("Error: Start column is higher than end column. No reverse range highlight.");return t}(),n=t.selectAll("g.highlight").data(e,function(t){return e=t[0],n=t[1],(e+n)*(e+n+1)/2+n;var e,n});n.exit().remove(),n.enter().append("g").attr("class","highlight").append("rect").attr("x",function(t){return t[0]*u}).attr("y",function(t){return t[1]*u}).attr("width",u).attr("height",u).style("fill",A).style("fill-opacity",k).style("pointer-events","none")}else console.log("Error: Can't update highlight. Heatmap was not initialized yet or highlight was not defined.")}function S(A){var k=A.datum();n=k.length,r=k[0].length;var F=(u=o/n)*(r+2);a&&(s.top=s.top+50),l&&(s.top=s.top+20),v||(s.bottom=s.bottom+50),(h||x)&&(s.left=s.left+50);var S=0;for(let t=0;t<k.length;t++)for(let e=0;e<k[t].length;e++)k[t][e]>S&&(S=k[t][e]);if(c||(c=e.scaleLinear().domain([0,S/2,S]).range(["#FFFFDD","#3E9583","#1F2D86"])),t=A.append("svg").attr("width",o+s.left+s.right).attr("height",F+s.top+s.bottom).append("g").attr("transform","translate("+s.left+","+s.top+")"),h||x)if(h){var H=e.scaleLinear().domain(h).range([u*r,0]);t.append("g").attr("transform","translate(3, 0)").attr("class","rowLabel axis").call(e.axisLeft(H).ticks(20).tickFormat(d))}else t.selectAll(".rowLabel").data(x).enter().append("text").text(y).attr("x",0).attr("y",function(t,e){return e*u}).style("text-anchor","end").attr("transform","translate(-6,"+u/1.2+")").attr("class","rowLabel mono axis");if(f||p)if(f){var T=e.scaleLinear().domain(f).range([0,o-s.left-s.right]);t.append("g").attr("transform","translate(5,3)").attr("class","columnLabel axis").call(e.axisTop(T).ticks(20).tickFormat(g))}else t.selectAll(".columnLabel").data(p).enter().append("text").text(m).attr("y",function(t,e){return e*u}).attr("x",0).style("text-anchor","beginning").attr("transform","translate("+u/1.4+", -6) rotate(270)").attr("class","columnLabel mono axis");if(t.selectAll("g.column").data(k).enter().append("g").each(function(t,n){e.select(this).selectAll("rect").data(t).enter().append("rect").attr("x",function(t){return n*u}).attr("y",function(t,e){return e*u}).attr("class","bordered").attr("width",u).attr("height",u).style("stroke","white").style("stroke-opacity",.6).style("fill",function(t){return c(t)}).style("pointer-events","all").on("mouseover",function(t,e){return function(t,e,n){"function"==typeof L&&L(t,e,n)}(t,n,e)}).on("click",function(t,e){return function(t,e,n){"function"==typeof b&&b(t,e,n)}(t,n,e)})}),w&&w.length>0&&E(),a&&t.append("text").attr("class","title").attr("x",o/2).attr("y",-60).style("text-anchor","middle").text(a),l&&t.append("text").attr("class","subtitle").attr("x",o/2).attr("y",-40).style("text-anchor","middle").text(l),!v){var C=e.scaleLinear().domain([0,S]).range([0,o]),D=C.domain(),M=[];D[2]=D[1]-D[0];for(var N=0;N<10;N++)M.push(N*D[2]/9+D[0]);t.append("defs").append("linearGradient").attr("id","legend-traffic").attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","0%").selectAll("stop").data(e.range(10)).enter().append("stop").attr("offset",function(t,e){return C(M[e])/o}).attr("stop-color",function(t,e){return c(M[e])});var O=Math.min(.8*o,400),j=t.append("g").attr("class","legendWrapper").attr("transform","translate("+o/2+","+(u*r+40)+")");j.append("rect").attr("class","legendRect").attr("x",-O/2).attr("y",0).attr("width",O).attr("height",10).style("fill","url(#legend-traffic)"),j.append("text").attr("class","legendTitle").attr("x",0).attr("y",-10).style("text-anchor","middle").text(i);var B=e.scaleLinear().range([-O/2,O/2]).domain([0,S]),R=e.axisBottom().ticks(5).scale(B);j.append("g").attr("class","axis").attr("transform","translate(0,10)").call(R)}}return S.title=function(t){return arguments.length?(a=t,S):a},S.subtitle=function(t){return arguments.length?(l=t,S):l},S.legendLabel=function(t){return arguments.length?(i=t,S):i},S.width=function(t){return arguments.length?(o=t,S):o},S.margin=function(t){return arguments.length?(s=t,S):s},S.colorScale=function(t){return arguments.length?(c=t,S):c},S.xAxisScale=function(t){return arguments.length?(f=t,S):f},S.yAxisScale=function(t){return arguments.length?(h=t,S):h},S.xAxisLabelFormat=function(t){return arguments.length?(m=t,S):m},S.yAxisLabelFormat=function(t){return arguments.length?(y=t,S):y},S.xAxisTickFormat=function(t){return arguments.length?(g=t,S):g},S.yAxisTickFormat=function(t){return arguments.length?(d=t,S):d},S.hideLegend=function(t){return arguments.length?(v=t,S):v},S.onClick=function(t){return arguments.length?(b=t,S):b},S.onMouseOver=function(t){return arguments.length?(L=t,S):L},S.xAxisLabels=function(t){return arguments.length?(p=t,S):p},S.yAxisLabels=function(t){return arguments.length?(x=t,S):x},S.highlightColor=function(t){return arguments.length?(A=t,S):A},S.highlightOpacity=function(t){return arguments.length?(k=t,S):k},S.setHighlight=function(t){return arguments.length?(w=t,S):w},S.invertHighlightRows=function(t){return arguments.length?(F=t,S):F},S.updateHighlight=E,S},Object.defineProperty(t,"__esModule",{value:!0})});