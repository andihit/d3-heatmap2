!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("d3")):"function"==typeof define&&define.amd?define(["exports","d3"],e):e(t.d3=t.d3||{},t.d3)}(this,function(t,e){"use strict";t.heatmap=function(){var t=null,n=0,r=0,a="",l="",i="",o=960,s={top:20,right:0,bottom:0,left:0},c=null,u=null,f=null,h=null,g=e.format(".0f"),d=e.format(".2s"),p=20,x=20,m=null,y=null,v=function(t){return t},b=function(t){return t},L=!1,A=5,k=null,w=null,F=[],S="#936EB5",T="0.4",E=!1,O=.6;function H(){if(t&&r&&c){var e=function(){var t=[];for(var e in F)if(F[e].start[0]<=F[e].end[0])for(var n=F[e].start[0];n<=F[e].end[0];n++){var a=null;if(n>F[e].start[0]&&n<F[e].end[0])for(a=0;a<r;a++)t.push([n,a]);else if(n===F[e].start[0])if(E)if(n===F[e].end[0])if(F[e].start[1]>=F[e].end[1])for(a=F[e].start[1];a>=F[e].end[1];a--)t.push([n,a]);else console.log("Error: Start row is higher than end row. No reverse range highlight.");else for(a=F[e].start[1];a>=0;a--)t.push([n,a]);else if(n===F[e].end[0])if(F[e].start[1]<=F[e].end[1])for(a=F[e].start[1];a<=F[e].end[1];a++)t.push([n,a]);else console.log("Error: Start row is higher than end row. No reverse range highlight.");else for(a=F[e].start[1];a<r;a++)t.push([n,a]);else if(E)for(a=F[e].end[1];a<r;a++)t.push([n,a]);else for(a=F[e].end[1];a>=0;a--)t.push([n,a])}else console.log("Error: Start column is higher than end column. No reverse range highlight.");return t}(),n=t.selectAll("g.highlight").data(e,function(t){return e=t[0],n=t[1],(e+n)*(e+n+1)/2+n;var e,n});n.exit().remove(),n.enter().append("g").attr("class","highlight").append("rect").attr("x",function(t){return t[0]*c+3}).attr("y",function(t){return t[1]*c}).attr("width",c).attr("height",c).style("fill",S).style("fill-opacity",T).style("pointer-events","none")}else console.log("Error: Can't update highlight. Heatmap was not initialized.")}function M(S){var T=S.datum();n=T.length,r=T[0].length;var E=Object.assign({},s);a&&(E.top=s.top+50),l&&(E.top=s.top+20),L||(E.bottom=s.bottom+50),(h||y)&&(E.left=s.left+50);var M=(c=(o-E.left-E.right)/n)*(r+2),j=0;for(let t=0;t<T.length;t++)for(let e=0;e<T[t].length;e++)T[t][e]>j&&(j=T[t][e]);u||(u=e.scaleLinear().domain([0,j/2,j]).range(["#FFFFDD","#3E9583","#1F2D86"])),t=S.append("svg").attr("width",o+E.left+E.right+9).attr("height",M+E.top+E.bottom).append("g").attr("transform","translate("+E.left+","+E.top+")");var z=Math.min(c,10);if(h||y)if(h){var C=e.scaleLinear().domain(h).range([c*r,0]);t.append("g").attr("transform","translate(3, 0)").attr("class","rowLabel axis").call(e.axisLeft(C).ticks(x).tickFormat(d))}else t.selectAll(".rowLabel").data(y).enter().append("text").text(b).attr("x",0).attr("y",function(t,e){return e*c}).style("text-anchor","end").style("font-size",z+"px").attr("transform","translate(-6,"+c/1.2+")").attr("class","rowLabel mono axis");if(f||m)if(f){var D=e.scaleLinear().domain(f).range([0,o-E.left-E.right]);t.append("g").attr("transform","translate(3, 3)").attr("class","columnLabel axis").call(e.axisTop(D).ticks(p).tickFormat(g))}else{var N=1.40333*z;t.selectAll(".columnLabel").data(m).enter().append("text").text(v).attr("y",function(t,e){return e*c}).attr("x",0).style("text-anchor","beginning").style("font-size",z+"px").attr("transform","translate("+(c+N)/2+", -6) rotate(270)").attr("class","columnLabel mono axis")}if(t.selectAll("g.column").data(T).enter().append("g").each(function(t,n){e.select(this).selectAll("rect").data(t).enter().append("rect").attr("x",function(t){return n*c+3}).attr("y",function(t,e){return e*c}).attr("class","bordered").attr("width",c).attr("height",c).style("stroke","white").style("stroke-opacity",O).style("fill",function(t){return u(t)}).style("pointer-events","all").on("mouseover",function(t,e){return function(t,e,n){"function"==typeof w&&w(t,e,n)}(t,n,e)}).on("click",function(t,e){return function(t,e,n){"function"==typeof k&&k(t,e,n)}(t,n,e)})}),F&&F.length>0&&H(),a&&t.append("text").attr("class","title").attr("x",o/2).attr("y",-60).style("text-anchor","middle").text(a),l&&t.append("text").attr("class","subtitle").attr("x",o/2).attr("y",-40).style("text-anchor","middle").text(l),!L){var B=e.scaleLinear().domain([0,j]).range([0,o]),R=B.domain(),_=[];R[2]=R[1]-R[0];for(var q=0;q<10;q++)_.push(q*R[2]/9+R[0]);t.append("defs").append("linearGradient").attr("id","legend-traffic").attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","0%").selectAll("stop").data(e.range(10)).enter().append("stop").attr("offset",function(t,e){return B(_[e])/o}).attr("stop-color",function(t,e){return u(_[e])});var G=Math.min(.8*o,400),P=t.append("g").attr("class","legendWrapper").attr("transform","translate("+o/2+","+(c*r+40)+")");P.append("rect").attr("class","legendRect").attr("x",-G/2).attr("y",0).attr("width",G).attr("height",10).style("fill","url(#legend-traffic)"),P.append("text").attr("class","legendTitle").attr("x",0).attr("y",-10).style("text-anchor","middle").text(i);var W=e.scaleLinear().range([-G/2,G/2]).domain([0,j]),I=e.axisBottom().ticks(A).scale(W);P.append("g").attr("class","axis").attr("transform","translate(0,10)").call(I)}}return M.title=function(t){return arguments.length?(a=t,M):a},M.subtitle=function(t){return arguments.length?(l=t,M):l},M.legendLabel=function(t){return arguments.length?(i=t,M):i},M.width=function(t){return arguments.length?(o=t,M):o},M.margin=function(t){return arguments.length?(s=t,M):s},M.colorScale=function(t){return arguments.length?(u=t,M):u},M.xAxisScale=function(t){return arguments.length?(f=t,M):f},M.yAxisScale=function(t){return arguments.length?(h=t,M):h},M.xAxisScaleTicks=function(t){return arguments.length?(p=t,M):p},M.yAxisScaleTicks=function(t){return arguments.length?(x=t,M):x},M.xAxisLabelFormat=function(t){return arguments.length?(v=t,M):v},M.yAxisLabelFormat=function(t){return arguments.length?(b=t,M):b},M.xAxisTickFormat=function(t){return arguments.length?(g=t,M):g},M.yAxisTickFormat=function(t){return arguments.length?(d=t,M):d},M.hideLegend=function(t){return arguments.length?(L=t,M):L},M.legendScaleTicks=function(t){return arguments.length?(A=t,M):A},M.onClick=function(t){return arguments.length?(k=t,M):k},M.onMouseOver=function(t){return arguments.length?(w=t,M):w},M.xAxisLabels=function(t){return arguments.length?(m=t,M):m},M.yAxisLabels=function(t){return arguments.length?(y=t,M):y},M.gridStrokeOpacity=function(t){return arguments.length?(O=t,M):O},M.highlightColor=function(t){return arguments.length?(S=t,M):S},M.highlightOpacity=function(t){return arguments.length?(T=t,M):T},M.setHighlight=function(t){return arguments.length?(F=t,M):F},M.invertHighlightRows=function(t){return arguments.length?(E=t,M):E},M.updateHighlight=H,M},Object.defineProperty(t,"__esModule",{value:!0})});