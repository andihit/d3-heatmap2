!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.d3=t.d3||{})}(this,function(t){"use strict";t.heatmap=function(){var t=null,e=0,n=0,r="",a="",l="",i=960,o={top:20,right:0,bottom:0,left:0},s=null,c=null,u=null,f=null,d=d3.format(".0f"),h=d3.format(".2s"),g=null,p=null,x=function(t){return t},m=function(t){return t},y=!1,v=null,b=null,L=[],A="#936EB5",w="0.4";function k(){if(L&&L.length>0&&t&&n&&s){var e=function(){var t=[];for(var e in L)if(L[e].start[0]<=L[e].end[0])for(var r=L[e].start[0];r<=L[e].end[0];r++){var a=null;if(r>L[e].start[0]&&r<L[e].end[0])for(a=0;a<n;a++)t.push([r,a]);else if(r===L[e].start[0])if(r===L[e].end[0])if(L[e].start[1]<=L[e].end[1])for(a=L[e].start[1];a<=L[e].end[1];a++)t.push([r,a]);else console.log("Error: Start row is higher than end row. No reverse range highlight.");else for(a=L[e].start[1];a<n;a++)t.push([r,a]);else for(a=L[e].end[1];a>=0;a--)t.push([r,a])}else console.log("Error: Start column is higher than end column. No reverse range highlight.");return t}(),r=t.selectAll("g.highlight").data(e,function(t){return e=t[0],n=t[1],(e+n)*(e+n+1)/2+n;var e,n});r.exit().remove(),r.enter().append("g").attr("class","highlight").append("rect").attr("x",function(t){return t[0]*s}).attr("y",function(t){return t[1]*s}).attr("width",s).attr("height",s).style("fill",A).style("fill-opacity",w).style("pointer-events","none")}else console.log("Error: Can't update highlight. Heatmap was not initialized yet or highlight was not defined.")}function F(A){var w=A.datum();e=w.length,n=w[0].length;var F=(s=i/e)*(n+2);r&&(o.top=o.top+50),a&&(o.top=o.top+20),y||(o.bottom=o.bottom+50),(f||p)&&(o.left=o.left+50);var E=0;for(let t=0;t<w.length;t++)for(let e=0;e<w[t].length;e++)w[t][e]>E&&(E=w[t][e]);if(c||(c=d3.scaleLinear().domain([0,E/2,E]).range(["#FFFFDD","#3E9583","#1F2D86"])),t=A.append("svg").attr("width",i+o.left+o.right).attr("height",F+o.top+o.bottom).append("g").attr("transform","translate("+o.left+","+o.top+")"),f||p)if(f){var S=d3.scaleLinear().domain(f).range([F,0]);t.append("g").attr("transform","translate(3,-12)").attr("class","rowLabel axis").call(d3.axisLeft(S).ticks(20).tickFormat(h))}else t.selectAll(".rowLabel").data(p).enter().append("text").text(m).attr("x",0).attr("y",function(t,e){return e*s}).style("text-anchor","end").attr("transform","translate(-6,"+s/1.2+")").attr("class","rowLabel mono axis");if(u||g)if(u){var T=d3.scaleLinear().domain(u).range([0,i-o.left-o.right]);t.append("g").attr("transform","translate(5,3)").attr("class","columnLabel axis").call(d3.axisTop(T).ticks(20).tickFormat(d))}else t.selectAll(".columnLabel").data(g).enter().append("text").text(x).attr("y",function(t,e){return e*s}).attr("x",0).style("text-anchor","beginning").attr("transform","translate("+s/1.4+", -6) rotate(270)").attr("class","columnLabel mono axis");if(t.selectAll("g.column").data(w).enter().append("g").each(function(t,e){d3.select(this).selectAll("rect").data(t).enter().append("rect").attr("x",function(t){return e*s}).attr("y",function(t,e){return e*s}).attr("class","bordered").attr("width",s).attr("height",s).style("stroke","white").style("stroke-opacity",.6).style("fill",function(t){return c(t)}).style("pointer-events","all").on("mouseover",function(t,n){return function(t,e,n){"function"==typeof b&&b(t,e,n)}(t,e,n)}).on("click",function(t,n){return function(t,e,n){"function"==typeof v&&v(t,e,n)}(t,e,n)})}),L&&L.length>0&&k(),r&&t.append("text").attr("class","title").attr("x",i/2).attr("y",-60).style("text-anchor","middle").text(r),a&&t.append("text").attr("class","subtitle").attr("x",i/2).attr("y",-40).style("text-anchor","middle").text(a),!y){var C=d3.scaleLinear().domain([0,E]).range([0,i]),D=C.domain(),H=[];D[2]=D[1]-D[0];for(var M=0;M<10;M++)H.push(M*D[2]/9+D[0]);t.append("defs").append("linearGradient").attr("id","legend-traffic").attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","0%").selectAll("stop").data(d3.range(10)).enter().append("stop").attr("offset",function(t,e){return C(H[e])/i}).attr("stop-color",function(t,e){return c(H[e])});var O=Math.min(.8*i,400),j=t.append("g").attr("class","legendWrapper").attr("transform","translate("+i/2+","+(s*n+40)+")");j.append("rect").attr("class","legendRect").attr("x",-O/2).attr("y",0).attr("width",O).attr("height",10).style("fill","url(#legend-traffic)"),j.append("text").attr("class","legendTitle").attr("x",0).attr("y",-10).style("text-anchor","middle").text(l);var B=d3.scaleLinear().range([-O/2,O/2]).domain([0,E]),N=d3.axisBottom().ticks(5).scale(B);j.append("g").attr("class","axis").attr("transform","translate(0,10)").call(N)}}return F.title=function(t){return arguments.length?(r=t,F):r},F.subtitle=function(t){return arguments.length?(a=t,F):a},F.legendLabel=function(t){return arguments.length?(l=t,F):l},F.width=function(t){return arguments.length?(i=t,F):i},F.margin=function(t){return arguments.length?(o=t,F):o},F.colorScale=function(t){return arguments.length?(c=t,F):c},F.xAxisScale=function(t){return arguments.length?(u=t,F):u},F.yAxisScale=function(t){return arguments.length?(f=t,F):f},F.xAxisLabelFormat=function(t){return arguments.length?(x=t,F):x},F.yAxisLabelFormat=function(t){return arguments.length?(m=t,F):m},F.xAxisTickFormat=function(t){return arguments.length?(d=t,F):d},F.yAxisTickFormat=function(t){return arguments.length?(h=t,F):h},F.hideLegend=function(t){return arguments.length?(y=t,F):y},F.onClick=function(t){return arguments.length?(v=t,F):v},F.onMouseOver=function(t){return arguments.length?(b=t,F):b},F.xAxisLabels=function(t){return arguments.length?(g=t,F):g},F.yAxisLabels=function(t){return arguments.length?(p=t,F):p},F.highlightColor=function(t){return arguments.length?(A=t,F):A},F.highlightOpacity=function(t){return arguments.length?(w=t,F):w},F.setHighlight=function(t){return arguments.length?(L=t,F):L},F.updateHighlight=k,F},Object.defineProperty(t,"__esModule",{value:!0})});